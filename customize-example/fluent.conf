<source>
  @type tail
  @id input_tail
  path /opt/jfrog/artifactory/var/log/access-service.log
  tag artifactory.access.service
  <parse>
    @type apache2
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/artifactory/var/log/artifactory-service.log
  tag artifactory.artifactory.service
  <parse>
    @type apache2
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/artifactory/var/log/frontend-service.log
  tag artifactory.frontend.service
  <parse>
    @type apache2
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/artifactory/var/log/metadata-service.log
  tag artifactory.metadata.service
  <parse>
    @type apache2
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/artifactory/var/log/router-service.log
  tag artifactory.router.service
  <parse>
    @type apache2
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/artifactory/var/log/router-traefik.log
  tag artifactory.router.traefik
  <parse>
    @type apache2
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/xray/var/log/xray-server-service.log
  tag xray.server.service
  <parse>
    @type apache2
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/xray/var/log/xray-persist-service.log
  tag xray.persist.service
  <parse>
    @type apache2
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/xray/var/log/xray-indexer-service.log
  tag xray.indexer.service
  <parse>
    @type apache2
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/xray/var/log/xray-analysis-service.log
  tag xray.analysis.service
  <parse>
    @type apache2
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/xray/var/log/router-service.log
  tag xray.router.service
  <parse>
    @type apache2
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/xray/var/log/router-traefik.log
  tag xray.router.traefik
  <parse>
    @type apache2
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/artifactory/var/log/access-request.log
  tag artifactory.access.request
  <parse>
    @type regexp
    expression /^(?<timestamp>[^ ]*)\|(?<trace_id>[^ ]*)\|(?<remote_addr>[^ ]*)\|(?<username>[^ ]*)\|(?<request_method>[^ ]*)\|(?<request_url>[^ ]*)\|(?<return_status>[^ ]*)\|(?<response_content_length>[^ ]*)\|(?<request_content_length>[^ ]*)\|(?<request_duration>[^ ]*)\|(?<request_user_agent>[^ ]*)$/
    time_key timestamp
    time_format %Y-%m-%dT%H:%M:%S.%zZ
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/artifactory/var/log/artifactory-request.log
  tag artifactory.artifactory.request
  <parse>
    @type regexp
    expression /^(?<timestamp>[^ ]*)\|(?<trace_id>[^ ]*)\|(?<remote_addr>[^ ]*)\|(?<username>[^ ]*)\|(?<request_method>[^ ]*)\|(?<request_url>[^ ]*)\|(?<return_status>[^ ]*)\|(?<response_content_length>[^ ]*)\|(?<request_content_length>[^ ]*)\|(?<request_duration>[^ ]*)\|(?<request_user_agent>[^ ]*)$/
    time_key timestamp
    time_format %Y-%m-%dT%H:%M:%S.%zZ
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/artifactory/var/log/frontend-request.log
  tag artifactory.frontend.request
  <parse>
    @type regexp
    expression /^(?<timestamp>[^ ]*)\|(?<trace_id>[^ ]*)\|(?<remote_addr>[^ ]*)\|(?<username>[^ ]*)\|(?<request_method>[^ ]*)\|(?<request_url>[^ ]*)\|(?<return_status>[^ ]*)\|(?<response_content_length>[^ ]*)\|(?<request_content_length>[^ ]*)\|(?<request_duration>[^ ]*)\|(?<request_user_agent>[^ ]*)$/
    time_key timestamp
    time_format %Y-%m-%dT%H:%M:%S.%zZ
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/artifactory/var/log/metadata-request.log
  tag artifactory.metadata.request
  <parse>
    @type regexp
    expression /^(?<timestamp>[^ ]*)\|(?<trace_id>[^ ]*)\|(?<remote_addr>[^ ]*)\|(?<username>[^ ]*)\|(?<request_method>[^ ]*)\|(?<request_url>[^ ]*)\|(?<return_status>[^ ]*)\|(?<response_content_length>[^ ]*)\|(?<request_content_length>[^ ]*)\|(?<request_duration>[^ ]*)\|(?<request_user_agent>[^ ]*)$/
    time_key timestamp
    time_format %Y-%m-%dT%H:%M:%S.%zZ
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/artifactory/var/log/router-request.log
  tag artifactory.router.request
  <parse>
    @type regexp
    expression /^(?<timestamp>[^ ]*)\|(?<trace_id>[^ ]*)\|(?<remote_addr>[^ ]*)\|(?<username>[^ ]*)\|(?<request_method>[^ ]*)\|(?<request_url>[^ ]*)\|(?<return_status>[^ ]*)\|(?<response_content_length>[^ ]*)\|(?<request_content_length>[^ ]*)\|(?<request_duration>[^ ]*)\|(?<request_user_agent>[^ ]*)$/
    time_key timestamp
    time_format %Y-%m-%dT%H:%M:%S.%zZ
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path  /opt/jfrog/xray/var/log/router-request.log
  tag xray.router.request
  <parse>
    @type regexp
    expression /^(?<timestamp>[^ ]*)\|(?<trace_id>[^ ]*)\|(?<remote_addr>[^ ]*)\|(?<username>[^ ]*)\|(?<request_method>[^ ]*)\|(?<request_url>[^ ]*)\|(?<return_status>[^ ]*)\|(?<response_content_length>[^ ]*)\|(?<request_content_length>[^ ]*)\|(?<request_duration>[^ ]*)\|(?<request_user_agent>[^ ]*)$/
    time_key timestamp
    time_format %Y-%m-%dT%H:%M:%S.%zZ
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path  /opt/jfrog/xray/var/log/xray-request.log
  tag xray.xray.request
  <parse>
    @type regexp
    expression /^(?<timestamp>[^ ]*)\|(?<trace_id>[^ ]*)\|(?<remote_addr>[^ ]*)\|(?<username>[^ ]*)\|(?<request_method>[^ ]*)\|(?<request_url>[^ ]*)\|(?<return_status>[^ ]*)\|(?<response_content_length>[^ ]*)\|(?<request_content_length>[^ ]*)\|(?<request_duration>[^ ]*)\|(?<request_user_agent>[^ ]*)$/
    time_key timestamp
    time_format %Y-%m-%dT%H:%M:%S.%zZ
  </parse>
</source>
<source>
  @type tail
  @id input_tail
  path /opt/jfrog/artifactory/var/log/artifactory-access.log
  tag artifactory.artifactory.access
  <parse>
    @type json
  </parse>
</source>
<match **>
  @type splunk_hec
  hec_host splunk.jfrog.tech
  hec_port 8089
  hec_token 402651df-d34a-49dd-8a11-4ee4847f29fb
  index main
  source ${tag}
  sourcetype _json
</match>
